---
/**
 * DoctorsList - Team/doctors section on homepage
 * Displays practice dentists with credentials and specialties
 */

import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';
import Button from '@/components/ui/Button.astro';

const team = await getCollection('team');
const doctors = team.sort((a, b) => a.data.order - b.data.order).slice(0, 3); // Showing top 3 for homepage
---

<section class="doctors-section section" aria-labelledby="doctors-heading">
  <div class="doctors-container">
    <header class="doctors-header">
      <h2 id="doctors-heading" class="doctors-title">Meet Our Doctors</h2>
      <p class="doctors-subtitle">
        Our experienced team is dedicated to providing exceptional dental care
        with a gentle, patient-first approach.
      </p>
    </header>

    <div class="doctors-grid grid-3">
      {doctors.map((doctor) => (
        <article class="doctor-card">
          <a href={`/team/${doctor.data.slug}`} class="doctor-card-link">
            <div class="doctor-image-wrapper">
              {doctor.data.image ? (
                <Image 
                  src={doctor.data.image} 
                  alt={doctor.data.name}
                  width={400} 
                  height={400}
                  class="h-full w-full object-cover"
                />
              ) : (
                <div class="doctor-image-placeholder" aria-hidden="true">
                  <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                    <circle cx="12" cy="7" r="4"/>
                  </svg>
                </div>
              )}
            </div>
            <div class="doctor-info">
              <h3 class="doctor-name">
                {doctor.data.name}
                <span class="doctor-credentials">{doctor.data.credentials ? doctor.data.credentials[0] : ''}</span>
              </h3>
              <p class="doctor-title">{doctor.data.role}</p>
              <p class="doctor-specialty">{doctor.data.specialties[0]}</p>
              <p class="doctor-bio">{doctor.data.shortBio}</p>
            </div>
          </a>
        </article>
      ))}
    </div>

    <div class="doctors-cta">
      <Button href="/about#team" variant="outline">
        Learn More About Our Team
      </Button>
    </div>
  </div>
</section>

<style>
  .doctors-section {
    background-color: var(--color-surface-elevated);
  }

  .doctors-container {
    width: 100%;
    max-width: var(--container-xl);
    margin-inline: auto;
    padding-inline: var(--spacing-element);
    box-sizing: border-box;
  }

  .doctors-header {
    text-align: center;
    max-width: 600px;
    margin-inline: auto;
    margin-bottom: var(--spacing-block);
  }

  .doctors-title {
    margin-bottom: 1rem;
  }

  .doctors-subtitle {
    font-size: var(--font-size-lg);
    color: var(--color-text-muted);
    line-height: var(--line-height-relaxed);
  }

  .doctors-grid {
    width: 100%;
  }

  .doctor-card {
    display: flex;
    flex-direction: column;
    background: var(--color-surface);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--color-border);
    overflow: hidden;
    transition: box-shadow var(--transition-fast);

    &:hover {
      box-shadow: var(--shadow-lg);
      transform: translateY(-2px);
    }
  }

  .doctor-card-link {
    text-decoration: none;
    color: inherit;
    display: flex;
    flex-direction: column;
    height: 100%;
  }

  @media (min-width: 640px) {
    .doctor-card {
      border-radius: var(--radius-xl);
    }
  }

  .doctor-image-wrapper {
    position: relative;
    /* Square on mobile, 4:3 on larger screens */
    aspect-ratio: 1 / 1;
    background: linear-gradient(135deg, var(--color-primary-light), var(--color-secondary-light));
    overflow: hidden;
  }

  @media (min-width: 640px) {
    .doctor-image-wrapper {
      aspect-ratio: 4 / 3;
    }
  }

  .doctor-image-placeholder {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-primary);
    opacity: 0.6;

    & svg {
      width: 32px;
      height: 32px;
    }
  }

  @media (min-width: 640px) {
    .doctor-image-placeholder svg {
      width: 40px;
      height: 40px;
    }
  }

  @media (min-width: 1024px) {
    .doctor-image-placeholder svg {
      width: 48px;
      height: 48px;
    }
  }

  .doctor-info {
    padding: 0.75rem;
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }

  @media (min-width: 640px) {
    .doctor-info {
      padding: 1rem;
      gap: 0.375rem;
    }
  }

  @media (min-width: 1024px) {
    .doctor-info {
      padding: 1.5rem;
      gap: 0.5rem;
    }
  }

  .doctor-name {
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-semibold);
    display: flex;
    flex-direction: column;
    gap: 0.125rem;
  }

  @media (min-width: 640px) {
    .doctor-name {
      font-size: var(--font-size-base);
      flex-direction: row;
      align-items: baseline;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
  }

  @media (min-width: 1024px) {
    .doctor-name {
      font-size: var(--font-size-xl);
    }
  }

  .doctor-credentials {
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-medium);
    color: var(--color-primary);
  }

  @media (min-width: 640px) {
    .doctor-credentials {
      font-size: var(--font-size-sm);
    }
  }

  .doctor-title {
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-medium);
    color: var(--color-accent);
  }

  @media (min-width: 640px) {
    .doctor-title {
      font-size: var(--font-size-sm);
    }
  }

  .doctor-specialty {
    font-size: var(--font-size-xs);
    color: var(--color-text-muted);
    /* Hide on mobile to save space */
    display: none;
  }

  @media (min-width: 640px) {
    .doctor-specialty {
      display: block;
      font-size: var(--font-size-sm);
    }
  }

  .doctor-bio {
    font-size: var(--font-size-xs);
    color: var(--color-text-muted);
    line-height: var(--line-height-relaxed);
    margin-top: 0.25rem;
    /* Limit lines on mobile */
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  @media (min-width: 640px) {
    .doctor-bio {
      font-size: var(--font-size-sm);
      margin-top: 0.5rem;
      -webkit-line-clamp: 3;
    }
  }

  @media (min-width: 1024px) {
    .doctor-bio {
      -webkit-line-clamp: none;
    }
  }

  .doctors-cta {
    display: flex;
    justify-content: center;
    margin-top: var(--spacing-block);
  }
</style>
