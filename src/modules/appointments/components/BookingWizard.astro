---
/**
 * BookingWizard - CSS-first multi-step booking form
 * Uses radio buttons + :checked state for step navigation (no JS required)
 */

import { getCollection } from "astro:content";
import { doctors } from "../../../config/doctors";

const services = await getCollection("services");
const sortedServices = services.sort((a, b) => a.data.order - b.data.order);

// Create doctor name map for JavaScript
const doctorNames = Object.fromEntries(
  doctors.map((d) => [d.id, d.name])
);

// Create service title map for JavaScript
const serviceTitles = Object.fromEntries(
  sortedServices.map((s) => [s.data.slug, s.data.title])
);

// Contact info
const whatsappNumber = "8801610633569";
const emailAddress = "care@smilesavers.dental";

// Generate time slots
const timeSlots = [
  "9:00 AM", "9:30 AM", "10:00 AM", "10:30 AM", "11:00 AM", "11:30 AM",
  "1:00 PM", "1:30 PM", "2:00 PM", "2:30 PM", "3:00 PM", "3:30 PM",
  "4:00 PM", "4:30 PM", "5:00 PM"
];
---

<div class="booking-wizard">
  <!-- Step Navigation Radio Inputs (hidden) -->
  <input type="radio" name="wizard-step" id="step-1" class="step-radio" checked />
  <input type="radio" name="wizard-step" id="step-2" class="step-radio" />
  <input type="radio" name="wizard-step" id="step-3" class="step-radio" />
  <input type="radio" name="wizard-step" id="step-4" class="step-radio" />
  <input type="radio" name="wizard-step" id="step-5" class="step-radio" />

  <!-- Progress Indicator -->
  <div class="progress-bar">
    <div class="progress-step" data-step="1">
      <span class="step-number">1</span>
      <span class="step-label">Service</span>
    </div>
    <div class="progress-step" data-step="2">
      <span class="step-number">2</span>
      <span class="step-label">Doctor</span>
    </div>
    <div class="progress-step" data-step="3">
      <span class="step-number">3</span>
      <span class="step-label">Date & Time</span>
    </div>
    <div class="progress-step" data-step="4">
      <span class="step-number">4</span>
      <span class="step-label">Your Info</span>
    </div>
    <div class="progress-step" data-step="5">
      <span class="step-number">5</span>
      <span class="step-label">Confirm</span>
    </div>
  </div>

  <!-- Form wraps all steps -->
  <form class="wizard-form" id="booking-form">
    <!-- Step 1: Service Selection -->
    <div class="wizard-step" data-step="1">
      <h2 class="step-title">Select a Service</h2>
      <p class="step-description">Choose the service you'd like to book.</p>

      <div class="service-options">
        {sortedServices.map((service, index) => (
          <label class="service-option">
            <input
              type="radio"
              name="service"
              value={service.data.slug}
              required
              checked={index === 0}
            />
            <span class="option-content">
              <span class="option-title">{service.data.title}</span>
              <span class="option-description">{service.data.shortDescription}</span>
              {service.data.duration && (
                <span class="option-duration">{service.data.duration}</span>
              )}
            </span>
          </label>
        ))}
      </div>

      <div class="step-actions">
        <label for="step-2" class="btn btn-primary">
          Continue
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
        </label>
      </div>
    </div>

    <!-- Step 2: Doctor Selection -->
    <div class="wizard-step" data-step="2">
      <h2 class="step-title">Choose Your Doctor</h2>
      <p class="step-description">Select the dentist you'd like to see.</p>

      <div class="doctor-options">
        {doctors.map((doctor, index) => (
          <label class="doctor-option">
            <input
              type="radio"
              name="doctor"
              value={doctor.id}
              required
              checked={index === 0}
            />
            <span class="doctor-content">
              <span class="doctor-avatar">
                {doctor.image ? (
                  <img src={doctor.image} alt={doctor.name} loading="lazy" />
                ) : (
                  <span class="doctor-initials">{doctor.name.split(' ').map(n => n[0]).join('')}</span>
                )}
              </span>
              <span class="doctor-info">
                <span class="doctor-name">{doctor.name}, {doctor.credentials}</span>
                <span class="doctor-title">{doctor.title}</span>
                <span class="doctor-specialty">{doctor.specialty}</span>
              </span>
            </span>
          </label>
        ))}
      </div>

      <div class="step-actions">
        <label for="step-1" class="btn btn-outline">Back</label>
        <label for="step-3" class="btn btn-primary">
          Continue
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
        </label>
      </div>
    </div>

    <!-- Step 3: Date & Time Selection -->
    <div class="wizard-step" data-step="3">
      <h2 class="step-title">Choose Date & Time</h2>
      <p class="step-description">Select your preferred appointment slot.</p>

      <div class="datetime-grid">
        <div class="date-picker">
          <label for="date" class="form-label">Preferred Date</label>
          <input
            type="date"
            id="date"
            name="date"
            required
            min={new Date().toISOString().split('T')[0]}
            class="form-input"
          />
        </div>

        <div class="time-picker">
          <label class="form-label">Preferred Time</label>
          <div class="time-slots">
            {timeSlots.map((slot, index) => (
              <label class="time-slot">
                <input type="radio" name="time" value={slot} required checked={index === 0} />
                <span>{slot}</span>
              </label>
            ))}
          </div>
        </div>
      </div>

      <div class="step-actions">
        <label for="step-2" class="btn btn-outline">Back</label>
        <label for="step-4" class="btn btn-primary">
          Continue
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
        </label>
      </div>
    </div>

    <!-- Step 4: Patient Information -->
    <div class="wizard-step" data-step="4">
      <h2 class="step-title">Your Information</h2>
      <p class="step-description">Please provide your contact details.</p>

      <div class="patient-form">
        <div class="form-row">
          <div class="form-group">
            <label for="firstName" class="form-label">First Name *</label>
            <input type="text" id="firstName" name="firstName" required autocomplete="given-name" class="form-input" />
          </div>
          <div class="form-group">
            <label for="lastName" class="form-label">Last Name *</label>
            <input type="text" id="lastName" name="lastName" required autocomplete="family-name" class="form-input" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="email" class="form-label">Email *</label>
            <input type="email" id="email" name="email" required autocomplete="email" class="form-input" />
          </div>
          <div class="form-group">
            <label for="phone" class="form-label">Phone *</label>
            <input type="tel" id="phone" name="phone" required autocomplete="tel" class="form-input" />
          </div>
        </div>

        <div class="form-group">
          <label for="notes" class="form-label">Additional Notes</label>
          <textarea id="notes" name="notes" rows="3" class="form-textarea" placeholder="Any special requests or concerns..."></textarea>
        </div>

        <div class="form-group checkbox-group">
          <label class="checkbox-label">
            <input type="checkbox" name="newPatient" value="yes" />
            <span>I am a new patient</span>
          </label>
        </div>
      </div>

      <div class="step-actions">
        <label for="step-3" class="btn btn-outline">Back</label>
        <label for="step-5" class="btn btn-primary">
          Review Booking
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
        </label>
      </div>
    </div>

    <!-- Step 5: Confirmation -->
    <div class="wizard-step" data-step="5">
      <h2 class="step-title">Review Your Booking</h2>
      <p class="step-description">Please verify all details are correct before sending.</p>

      <!-- Dynamic Booking Summary -->
      <div class="booking-summary" id="booking-summary">
        <div class="summary-section">
          <h3 class="summary-heading">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
            Appointment Details
          </h3>
          <div class="summary-grid">
            <div class="summary-item">
              <span class="summary-label">Service</span>
              <span class="summary-value" id="summary-service">-</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Doctor</span>
              <span class="summary-value" id="summary-doctor">-</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Date</span>
              <span class="summary-value" id="summary-date">-</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Time</span>
              <span class="summary-value" id="summary-time">-</span>
            </div>
          </div>
        </div>

        <div class="summary-section">
          <h3 class="summary-heading">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
            Patient Information
          </h3>
          <div class="summary-grid">
            <div class="summary-item">
              <span class="summary-label">Name</span>
              <span class="summary-value" id="summary-name">-</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Phone</span>
              <span class="summary-value" id="summary-phone">-</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Email</span>
              <span class="summary-value" id="summary-email">-</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">New Patient</span>
              <span class="summary-value" id="summary-new-patient">-</span>
            </div>
          </div>
        </div>

        <div class="summary-section" id="summary-notes-section">
          <h3 class="summary-heading">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
            Additional Notes
          </h3>
          <p class="summary-notes" id="summary-notes">-</p>
        </div>
      </div>

      <div class="terms-group">
        <label class="checkbox-label">
          <input type="checkbox" name="terms" required id="terms-checkbox" />
          <span>I agree to the <a href="/terms">terms of service</a> and <a href="/privacy">privacy policy</a></span>
        </label>
      </div>

      <!-- Submit Options -->
      <div class="submit-section">
        <p class="submit-info">Choose how you'd like to send your appointment request:</p>
        <div class="submit-buttons">
          <button type="button" id="submit-whatsapp" class="btn btn-whatsapp">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="currentColor">
              <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
            </svg>
            Send via WhatsApp
          </button>
          <button type="button" id="submit-email" class="btn btn-email">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
              <polyline points="22,6 12,13 2,6"/>
            </svg>
            Send via Email
          </button>
        </div>
        <p class="submit-note">Your message will be formatted automatically. Just tap send!</p>
      </div>

      <div class="step-actions">
        <label for="step-4" class="btn btn-outline">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
          Back to Edit
        </label>
      </div>
    </div>
  </form>
</div>

<!-- Booking Form JavaScript -->
<script define:vars={{ serviceTitles, doctorNames, whatsappNumber, emailAddress }}>
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('booking-form');
    const step5Radio = document.getElementById('step-5');
    const whatsappBtn = document.getElementById('submit-whatsapp');
    const emailBtn = document.getElementById('submit-email');

    // Format date to readable string (e.g., "Monday, January 15, 2024")
    function formatDate(dateString) {
      if (!dateString) return '-';
      const date = new Date(dateString + 'T00:00:00');
      return date.toLocaleDateString('en-US', {
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      });
    }

    // Get all form data
    function getFormData() {
      const data = new FormData(form);
      const serviceSlug = data.get('service');
      const serviceTitle = serviceTitles[serviceSlug] || serviceSlug;
      const doctorId = data.get('doctor');
      const doctorName = doctorNames[doctorId] || doctorId;

      return {
        service: serviceTitle,
        serviceSlug: serviceSlug,
        doctor: doctorName,
        doctorId: doctorId,
        date: data.get('date'),
        dateFormatted: formatDate(data.get('date')),
        time: data.get('time'),
        firstName: data.get('firstName'),
        lastName: data.get('lastName'),
        fullName: `${data.get('firstName') || ''} ${data.get('lastName') || ''}`.trim(),
        email: data.get('email'),
        phone: data.get('phone'),
        notes: data.get('notes') || '',
        isNewPatient: data.get('newPatient') === 'yes',
        termsAccepted: document.getElementById('terms-checkbox').checked
      };
    }

    // Update summary display when entering Step 5
    function updateSummary() {
      const data = getFormData();

      document.getElementById('summary-service').textContent = data.service || '-';
      document.getElementById('summary-doctor').textContent = data.doctor || '-';
      document.getElementById('summary-date').textContent = data.dateFormatted || '-';
      document.getElementById('summary-time').textContent = data.time || '-';
      document.getElementById('summary-name').textContent = data.fullName || '-';
      document.getElementById('summary-phone').textContent = data.phone || '-';
      document.getElementById('summary-email').textContent = data.email || '-';
      document.getElementById('summary-new-patient').textContent = data.isNewPatient ? 'Yes' : 'No';

      const notesSection = document.getElementById('summary-notes-section');
      const notesEl = document.getElementById('summary-notes');
      if (data.notes) {
        notesSection.style.display = 'block';
        notesEl.textContent = data.notes;
      } else {
        notesSection.style.display = 'none';
      }
    }

    // Listen for Step 5 activation
    step5Radio.addEventListener('change', () => {
      if (step5Radio.checked) {
        updateSummary();
      }
    });

    // Validate before sending
    function validateForm() {
      const data = getFormData();
      const errors = [];

      if (!data.serviceSlug) errors.push('Please select a service');
      if (!data.doctorId) errors.push('Please select a doctor');
      if (!data.date) errors.push('Please select a date');
      if (!data.time) errors.push('Please select a time');
      if (!data.firstName) errors.push('Please enter your first name');
      if (!data.lastName) errors.push('Please enter your last name');
      if (!data.email) errors.push('Please enter your email');
      if (!data.phone) errors.push('Please enter your phone number');
      if (!data.termsAccepted) errors.push('Please accept the terms and conditions');

      if (errors.length > 0) {
        alert('Please complete all required fields:\n\n• ' + errors.join('\n• '));
        return false;
      }
      return true;
    }

    // Format message for WhatsApp
    function formatWhatsAppMessage(data) {
      let message = `*APPOINTMENT REQUEST*
*Smile Savers Dental*

-----------------------
*APPOINTMENT DETAILS*
-----------------------
Service: ${data.service}
Doctor: ${data.doctor}
Date: ${data.dateFormatted}
Time: ${data.time}

-----------------------
*PATIENT INFORMATION*
-----------------------
Name: ${data.fullName}
Phone: ${data.phone}
Email: ${data.email}
New Patient: ${data.isNewPatient ? 'Yes' : 'No'}`;

      if (data.notes) {
        message += `

-----------------------
*ADDITIONAL NOTES*
-----------------------
${data.notes}`;
      }

      return message;
    }

    // Format message for Email
    function formatEmailBody(data) {
      let body = `APPOINTMENT REQUEST
Smile Savers Dental
========================

APPOINTMENT DETAILS
-------------------
Service: ${data.service}
Preferred Doctor: ${data.doctor}
Preferred Date: ${data.dateFormatted}
Preferred Time: ${data.time}

PATIENT INFORMATION
-------------------
Name: ${data.fullName}
Phone: ${data.phone}
Email: ${data.email}
New Patient: ${data.isNewPatient ? 'Yes' : 'No'}`;

      if (data.notes) {
        body += `

ADDITIONAL NOTES
----------------
${data.notes}`;
      }

      return body;
    }

    // Send via WhatsApp
    function sendViaWhatsApp() {
      if (!validateForm()) return;

      const data = getFormData();
      const message = formatWhatsAppMessage(data);
      const url = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;

      window.open(url, '_blank');
    }

    // Send via Email
    function sendViaEmail() {
      if (!validateForm()) return;

      const data = getFormData();
      const subject = `Appointment Request: ${data.service} - ${data.dateFormatted}`;
      const body = formatEmailBody(data);
      const url = `mailto:${emailAddress}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

      window.location.href = url;
    }

    // Attach event listeners
    whatsappBtn.addEventListener('click', sendViaWhatsApp);
    emailBtn.addEventListener('click', sendViaEmail);
  });
</script>

<style>
  .booking-wizard {
    background: var(--color-surface-elevated);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-lg);
    overflow: hidden;
  }

  /* Hide radio inputs but keep functional */
  .step-radio {
    position: absolute;
    opacity: 0;
    pointer-events: none;
  }

  /* Progress Bar */
  .progress-bar {
    display: flex;
    justify-content: space-between;
    padding: 1.5rem 2rem;
    background: var(--color-surface-sunken);
    border-bottom: 1px solid var(--color-border);
  }

  .progress-step {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    flex: 1;
    position: relative;
  }

  .step-number {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    border-radius: var(--radius-full);
    background: var(--color-surface-elevated);
    border: 2px solid var(--color-border-strong);
    font-weight: var(--font-weight-semibold);
    font-size: var(--font-size-sm);
    color: var(--color-text);
    transition: all var(--transition-fast);
  }

  .step-label {
    font-size: var(--font-size-xs);
    color: var(--color-text-muted);
    text-align: center;
  }

  /* Progress bar active states */
  #step-1:checked ~ .progress-bar .progress-step[data-step="1"] .step-number,
  #step-2:checked ~ .progress-bar .progress-step[data-step="1"] .step-number,
  #step-2:checked ~ .progress-bar .progress-step[data-step="2"] .step-number,
  #step-3:checked ~ .progress-bar .progress-step[data-step="1"] .step-number,
  #step-3:checked ~ .progress-bar .progress-step[data-step="2"] .step-number,
  #step-3:checked ~ .progress-bar .progress-step[data-step="3"] .step-number,
  #step-4:checked ~ .progress-bar .progress-step[data-step="1"] .step-number,
  #step-4:checked ~ .progress-bar .progress-step[data-step="2"] .step-number,
  #step-4:checked ~ .progress-bar .progress-step[data-step="3"] .step-number,
  #step-4:checked ~ .progress-bar .progress-step[data-step="4"] .step-number,
  #step-5:checked ~ .progress-bar .progress-step[data-step="1"] .step-number,
  #step-5:checked ~ .progress-bar .progress-step[data-step="2"] .step-number,
  #step-5:checked ~ .progress-bar .progress-step[data-step="3"] .step-number,
  #step-5:checked ~ .progress-bar .progress-step[data-step="4"] .step-number,
  #step-5:checked ~ .progress-bar .progress-step[data-step="5"] .step-number {
    background: var(--color-primary);
    border-color: var(--color-primary);
    color: var(--color-text-inverted);
  }

  /* Wizard Steps */
  .wizard-step {
    display: none;
    padding: 2rem;
  }

  #step-1:checked ~ .wizard-form .wizard-step[data-step="1"],
  #step-2:checked ~ .wizard-form .wizard-step[data-step="2"],
  #step-3:checked ~ .wizard-form .wizard-step[data-step="3"],
  #step-4:checked ~ .wizard-form .wizard-step[data-step="4"],
  #step-5:checked ~ .wizard-form .wizard-step[data-step="5"] {
    display: block;
  }

  .step-title {
    font-size: var(--font-size-2xl);
    margin-bottom: 0.5rem;
    color: var(--color-text);
  }

  .step-description {
    color: var(--color-text-muted);
    margin-bottom: 2rem;
  }

  /* Service Options */
  .service-options {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin-bottom: 2rem;
  }

  .service-option {
    display: flex;
    cursor: pointer;
  }

  .service-option input {
    position: absolute;
    opacity: 0;
  }

  .option-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    padding: 1rem 1.25rem;
    border: 2px solid var(--color-border-strong);
    border-radius: var(--radius-lg);
    background: var(--color-surface-elevated);
    transition: all var(--transition-fast);
  }

  .service-option input:checked + .option-content {
    border-color: var(--color-primary);
    background: rgba(16, 43, 63, 0.05);
  }

  .service-option:hover .option-content {
    border-color: var(--color-primary-light);
  }

  .option-title {
    font-weight: var(--font-weight-semibold);
    color: var(--color-text);
  }

  .option-description {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
  }

  .option-duration {
    font-size: var(--font-size-xs);
    color: var(--color-primary);
  }

  /* Doctor Options */
  .doctor-options {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin-bottom: 2rem;
  }

  .doctor-option {
    display: flex;
    cursor: pointer;
  }

  .doctor-option input {
    position: absolute;
    opacity: 0;
  }

  .doctor-content {
    flex: 1;
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem 1.25rem;
    border: 2px solid var(--color-border-strong);
    border-radius: var(--radius-lg);
    background: var(--color-surface-elevated);
    transition: all var(--transition-fast);
  }

  .doctor-option input:checked + .doctor-content {
    border-color: var(--color-primary);
    background: rgba(16, 43, 63, 0.05);
  }

  .doctor-option:hover .doctor-content {
    border-color: var(--color-primary-light);
  }

  .doctor-avatar {
    width: 60px;
    height: 60px;
    border-radius: var(--radius-full);
    overflow: hidden;
    flex-shrink: 0;
    background: var(--color-surface-sunken);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .doctor-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .doctor-initials {
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    color: var(--color-primary);
  }

  .doctor-info {
    display: flex;
    flex-direction: column;
    gap: 0.125rem;
  }

  .doctor-name {
    font-weight: var(--font-weight-semibold);
    color: var(--color-text);
  }

  .doctor-title {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
  }

  .doctor-specialty {
    font-size: var(--font-size-xs);
    color: var(--color-primary);
  }

  /* Date/Time Selection */
  .datetime-grid {
    display: grid;
    gap: 2rem;
    margin-bottom: 2rem;
  }

  .time-slots {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 0.5rem;
    margin-top: 0.5rem;
  }

  .time-slot {
    cursor: pointer;
  }

  .time-slot input {
    position: absolute;
    opacity: 0;
  }

  .time-slot span {
    display: block;
    padding: 0.75rem;
    text-align: center;
    border: 1px solid var(--color-border-strong);
    border-radius: var(--radius-md);
    font-size: var(--font-size-sm);
    color: var(--color-text);
    background: var(--color-surface-elevated);
    transition: all var(--transition-fast);
  }

  .time-slot input:checked + span {
    background: var(--color-primary);
    border-color: var(--color-primary);
    color: var(--color-text-inverted);
  }

  .time-slot:hover span {
    border-color: var(--color-primary-light);
  }

  /* Form Styles */
  .patient-form {
    display: flex;
    flex-direction: column;
    gap: 1.25rem;
    margin-bottom: 2rem;
  }

  .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
  }

  @media (max-width: 480px) {
    .form-row {
      grid-template-columns: 1fr;
    }
  }

  .form-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .form-label {
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    color: var(--color-text);
  }

  .form-input,
  .form-textarea {
    padding: 0.75rem 1rem;
    border: 1px solid var(--color-border-strong);
    border-radius: var(--radius-md);
    font-size: var(--font-size-base);
    background: var(--color-surface-elevated);
    color: var(--color-text);
    transition: border-color var(--transition-fast), box-shadow var(--transition-fast);

    &::placeholder {
      color: var(--color-text-muted);
    }

    &:focus {
      outline: none;
      border-color: var(--color-primary);
      box-shadow: 0 0 0 3px rgba(16, 43, 63, 0.15);
    }
  }

  .checkbox-group {
    flex-direction: row;
  }

  .checkbox-label {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    cursor: pointer;
    font-size: var(--font-size-sm);
    color: var(--color-text);
  }

  .checkbox-label input {
    width: 18px;
    height: 18px;
    accent-color: var(--color-primary);
  }

  /* Confirmation */
  .confirmation-card {
    text-align: center;
    padding: 2rem;
    background: var(--color-surface-sunken);
    border-radius: var(--radius-lg);
    margin-bottom: 2rem;
  }

  .confirmation-icon {
    color: var(--color-primary);
    margin-bottom: 1rem;
  }

  .confirmation-text {
    color: var(--color-text-muted);
    line-height: var(--line-height-relaxed);
  }

  .terms-group {
    margin-bottom: 2rem;
  }

  .terms-group a {
    color: var(--color-primary);
    text-decoration: underline;
  }

  /* Actions */
  .step-actions {
    display: flex;
    justify-content: space-between;
    gap: 1rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--color-border);
  }

  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.875rem 1.5rem;
    font-weight: var(--font-weight-medium);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all var(--transition-fast);
    border: none;
    text-decoration: none;
  }

  .btn-primary {
    background: var(--color-accent);
    color: white;

    &:hover {
      background: #1A95C9;
    }
  }

  .btn-outline {
    background: var(--color-surface-elevated);
    border: 2px solid var(--color-border-strong);
    color: var(--color-text);

    &:hover {
      border-color: var(--color-accent);
      color: var(--color-accent);
    }
  }

  /* Booking Summary Styles */
  .booking-summary {
    background: var(--color-surface-sunken);
    border-radius: var(--radius-lg);
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    border: 1px solid var(--color-border);
  }

  .summary-section {
    padding-bottom: 1.25rem;
    margin-bottom: 1.25rem;
    border-bottom: 1px solid var(--color-border);

    &:last-child {
      padding-bottom: 0;
      margin-bottom: 0;
      border-bottom: none;
    }
  }

  .summary-heading {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-semibold);
    color: var(--color-primary);
    margin-bottom: 1rem;

    svg {
      flex-shrink: 0;
      color: var(--color-primary);
    }
  }

  .summary-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 1rem;
  }

  .summary-item {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }

  .summary-label {
    font-size: var(--font-size-xs);
    color: var(--color-text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .summary-value {
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    color: var(--color-text);
  }

  .summary-notes {
    font-size: var(--font-size-sm);
    color: var(--color-text);
    line-height: var(--line-height-relaxed);
    white-space: pre-wrap;
  }

  /* Submit Section Styles */
  .submit-section {
    text-align: center;
    padding: 1.5rem;
    background: var(--color-surface-elevated);
    border-radius: var(--radius-lg);
    border: 2px solid var(--color-border);
    margin-bottom: 1.5rem;
  }

  .submit-info {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
    margin-bottom: 1rem;
  }

  .submit-buttons {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;

    @media (min-width: 480px) {
      flex-direction: row;
      justify-content: center;
    }
  }

  .submit-note {
    font-size: var(--font-size-xs);
    color: var(--color-text-muted);
    margin-top: 1rem;
  }

  .btn-whatsapp {
    background: #25D366;
    color: white;
    flex: 1;

    &:hover {
      background: #1da851;
    }

    @media (min-width: 480px) {
      flex: none;
    }
  }

  .btn-email {
    background: var(--color-primary);
    color: var(--color-text-inverted);
    flex: 1;

    &:hover {
      background: var(--color-primary-dark);
    }

    @media (min-width: 480px) {
      flex: none;
    }
  }
</style>
