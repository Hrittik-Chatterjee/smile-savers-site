---
/**
 * GlossaryPageLayout - Template for "what is [term]" educational pages
 *
 * URL Pattern: /learn/[term]/
 * Example: /learn/dental-implants/
 *
 * This layout provides unique value through:
 * - Clear, expert definitions
 * - In-depth educational content
 * - Connection to relevant services
 * - Related terms for topic clusters
 */

import PageLayout from '../../../layouts/PageLayout.astro';
import Breadcrumbs from '../components/Breadcrumbs.astro';
import FAQSection from '../components/FAQSection.astro';
import CTABanner from '../components/CTABanner.astro';
import RelatedServices from '../components/RelatedServices.astro';
import TrustBadges from '../components/TrustBadges.astro';

interface FAQItem {
  question: string;
  answer: string;
}

interface Props {
  term: string;
  termDisplay: string;
  definition: string;
  content: string;  // HTML content
  faqs: FAQItem[];
  relatedTerms: { term: string; slug: string }[];
  relatedServices: string[];
}

const {
  term,
  termDisplay,
  definition,
  content,
  faqs,
  relatedTerms,
  relatedServices,
} = Astro.props;

// SEO
const title = `What is ${termDisplay}? | Dental Guide | Smile Savers`;
const description = `${definition.slice(0, 150)}... Learn everything about ${termDisplay.toLowerCase()} from our experienced dental team.`;
const canonicalUrl = `/learn/${term}/`;

// Breadcrumbs
const breadcrumbs = [
  { label: 'Home', href: '/' },
  { label: 'Learn', href: '/learn' },
  { label: termDisplay },
];

// Schema.org Article markup
const articleSchema = {
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": `What is ${termDisplay}?`,
  "description": definition,
  "author": {
    "@type": "Organization",
    "name": "Smile Savers",
    "url": "https://smilesavers.dental"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Smile Savers",
    "url": "https://smilesavers.dental"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": `https://smilesavers.dental${canonicalUrl}`
  }
};
---

<PageLayout title={title} description={description} canonicalUrl={canonicalUrl}>
  <article class="glossary-page">
    <div class="page-container">
      <Breadcrumbs items={breadcrumbs} />

      <!-- Hero Section -->
      <header class="glossary-hero">
        <span class="content-type">Dental Term</span>
        <h1 class="page-title">What is {termDisplay}?</h1>

        <div class="definition-box">
          <p class="definition">{definition}</p>
        </div>

        <div class="author-info">
          <div class="author-avatar">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
              <circle cx="12" cy="7" r="4"/>
            </svg>
          </div>
          <div class="author-details">
            <span class="author-name">Reviewed by Smile Savers Dental Team</span>
            <span class="author-credentials">35+ Years of Dental Experience</span>
          </div>
        </div>
      </header>

      <!-- Table of Contents (auto-generated from H2s would be added with JS) -->

      <!-- Main Content -->
      <div class="content-wrapper">
        <div class="main-content prose" set:html={content} />

        <aside class="sidebar">
          <!-- Trust Signals -->
          <div class="sidebar-card">
            <h3 class="sidebar-title">Expert Care</h3>
            <TrustBadges variant="grid" size="sm" />
          </div>

          <!-- Related Terms -->
          {relatedTerms.length > 0 && (
            <div class="sidebar-card">
              <h3 class="sidebar-title">Related Terms</h3>
              <nav class="related-terms" aria-label="Related dental terms">
                {relatedTerms.map((related) => (
                  <a href={`/learn/${related.slug}/`} class="related-term-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                      <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                      <polyline points="15 3 21 3 21 9"/>
                      <line x1="10" y1="14" x2="21" y2="3"/>
                    </svg>
                    {related.term}
                  </a>
                ))}
              </nav>
            </div>
          )}

          <!-- Quick CTA -->
          <div class="sidebar-card sidebar-cta-card">
            <h3 class="sidebar-title">Have Questions?</h3>
            <p class="sidebar-text">Our team is here to help you understand your dental health.</p>
            <a href="/contact" class="sidebar-cta">Contact Us</a>
          </div>
        </aside>
      </div>

      <!-- FAQ Section -->
      {faqs.length > 0 && (
        <FAQSection
          items={faqs}
          title={`Common Questions About ${termDisplay}`}
        />
      )}

      <!-- Related Services -->
      <RelatedServices
        services={relatedServices}
        title={`${termDisplay} Services at Smile Savers`}
      />

      <!-- CTA Banner -->
      <CTABanner
        headline={`Need Help With ${termDisplay}?`}
        description="Schedule a consultation with our experienced dental team to discuss your options."
      />
    </div>
  </article>

  <script type="application/ld+json" set:html={JSON.stringify(articleSchema)} />
</PageLayout>

<style>
  .glossary-page {
    padding-bottom: var(--spacing-section);
  }

  .page-container {
    max-width: var(--container-xl);
    margin-inline: auto;
    padding-inline: var(--spacing-element);
  }

  .glossary-hero {
    padding-block: var(--spacing-block);
    max-width: var(--container-lg);
  }

  .content-type {
    display: inline-block;
    padding: 0.25rem 0.75rem;
    background: var(--color-secondary-light);
    color: var(--color-secondary);
    border-radius: var(--radius-full);
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-semibold);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 1rem;
  }

  .page-title {
    font-size: var(--font-size-4xl);
    line-height: var(--line-height-tight);
    margin-bottom: 1.5rem;
  }

  .definition-box {
    background: var(--color-surface-sunken);
    border-left: 4px solid var(--color-primary);
    padding: 1.5rem;
    border-radius: 0 var(--radius-lg) var(--radius-lg) 0;
    margin-bottom: 1.5rem;
  }

  .definition {
    font-size: var(--font-size-lg);
    color: var(--color-text);
    line-height: var(--line-height-relaxed);
    margin: 0;
  }

  .author-info {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding-top: 1rem;
    border-top: 1px solid var(--color-border);
  }

  .author-avatar {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 48px;
    height: 48px;
    background: var(--color-primary-light);
    color: var(--color-primary-dark);
    border-radius: var(--radius-full);
  }

  .author-details {
    display: flex;
    flex-direction: column;
  }

  .author-name {
    font-weight: var(--font-weight-medium);
    font-size: var(--font-size-sm);
  }

  .author-credentials {
    font-size: var(--font-size-xs);
    color: var(--color-text-muted);
  }

  .content-wrapper {
    display: grid;
    gap: 2rem;
    padding-block: var(--spacing-block);
  }

  @media (min-width: 1024px) {
    .content-wrapper {
      grid-template-columns: 1fr 300px;
      gap: 3rem;
    }
  }

  .main-content {
    max-width: var(--container-prose);
  }

  .prose {
    font-size: var(--font-size-base);
    line-height: var(--line-height-relaxed);
    color: var(--color-text-muted);
  }

  .prose :global(h2) {
    font-size: var(--font-size-2xl);
    color: var(--color-text);
    margin-top: 2rem;
    margin-bottom: 1rem;
  }

  .prose :global(h3) {
    font-size: var(--font-size-xl);
    color: var(--color-text);
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
  }

  .prose :global(p) {
    margin-bottom: 1rem;
  }

  .prose :global(ul),
  .prose :global(ol) {
    margin-bottom: 1rem;
    padding-left: 1.5rem;
  }

  .prose :global(li) {
    margin-bottom: 0.5rem;
  }

  .prose :global(strong) {
    color: var(--color-text);
    font-weight: var(--font-weight-semibold);
  }

  .sidebar {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  .sidebar-card {
    background: var(--color-surface-elevated);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-xl);
    padding: 1.5rem;
  }

  .sidebar-title {
    font-size: var(--font-size-base);
    margin-bottom: 1rem;
  }

  .related-terms {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .related-term-link {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
  }

  .related-term-link:hover {
    color: var(--color-primary);
  }

  .related-term-link svg {
    color: var(--color-primary);
    opacity: 0.5;
  }

  .sidebar-cta-card {
    background: linear-gradient(135deg, var(--color-primary-light), var(--color-secondary-light));
    border: none;
  }

  .sidebar-text {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
    margin-bottom: 1rem;
  }

  .sidebar-cta {
    display: block;
    text-align: center;
    padding: 0.75rem;
    background: var(--color-primary);
    color: var(--color-text-inverted);
    border-radius: var(--radius-lg);
    font-weight: var(--font-weight-semibold);
    font-size: var(--font-size-sm);
    text-decoration: none;
    transition: background-color var(--transition-fast);
  }

  .sidebar-cta:hover {
    background: var(--color-primary-dark);
  }
</style>
