---
/**
 * ComparisonTable - Side-by-side feature comparison
 * Used for "[X] vs [Y]" comparison pages
 */

interface ComparisonOption {
  name: string;
  pros: string[];
  cons: string[];
  cost: string;
  duration: string;
  longevity: string;
  bestFor: string;
}

interface Props {
  optionA: ComparisonOption;
  optionB: ComparisonOption;
}

const { optionA, optionB } = Astro.props;

const features = [
  { key: 'cost', label: 'Typical Cost', icon: 'dollar' },
  { key: 'duration', label: 'Treatment Time', icon: 'clock' },
  { key: 'longevity', label: 'How Long It Lasts', icon: 'calendar' },
  { key: 'bestFor', label: 'Best For', icon: 'user' },
];

const iconPaths: Record<string, string> = {
  dollar: 'M12 1v22M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6',
  clock: 'M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20zM12 6v6l4 2',
  calendar: 'M8 2v4M16 2v4M3 10h18M5 4h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z',
  user: 'M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2M12 11a4 4 0 1 0 0-8 4 4 0 0 0 0 8z',
  check: 'M20 6L9 17l-5-5',
  x: 'M18 6L6 18M6 6l12 12',
};
---

<div class="comparison-wrapper">
  <!-- Mobile: Stacked cards -->
  <div class="comparison-mobile">
    {[optionA, optionB].map((option) => (
      <div class="comparison-card">
        <h3 class="option-title">{option.name}</h3>

        <div class="feature-list">
          {features.map((feature) => (
            <div class="feature-row">
              <span class="feature-label">{feature.label}</span>
              <span class="feature-value">{option[feature.key as keyof ComparisonOption]}</span>
            </div>
          ))}
        </div>

        <div class="pros-cons">
          <div class="pros">
            <h4 class="pros-title">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <path d={iconPaths.check} />
              </svg>
              Pros
            </h4>
            <ul>
              {option.pros.map((pro) => <li>{pro}</li>)}
            </ul>
          </div>
          <div class="cons">
            <h4 class="cons-title">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <path d={iconPaths.x} />
              </svg>
              Cons
            </h4>
            <ul>
              {option.cons.map((con) => <li>{con}</li>)}
            </ul>
          </div>
        </div>
      </div>
    ))}
  </div>

  <!-- Desktop: Side-by-side table -->
  <table class="comparison-table">
    <thead>
      <tr>
        <th class="feature-header">Feature</th>
        <th class="option-header">{optionA.name}</th>
        <th class="option-header">{optionB.name}</th>
      </tr>
    </thead>
    <tbody>
      {features.map((feature) => (
        <tr>
          <td class="feature-cell">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d={iconPaths[feature.icon]} />
            </svg>
            {feature.label}
          </td>
          <td class="value-cell">{optionA[feature.key as keyof ComparisonOption]}</td>
          <td class="value-cell">{optionB[feature.key as keyof ComparisonOption]}</td>
        </tr>
      ))}
      <tr class="pros-row">
        <td class="feature-cell">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d={iconPaths.check} />
          </svg>
          Pros
        </td>
        <td class="value-cell pros-cell">
          <ul>{optionA.pros.map((pro) => <li>{pro}</li>)}</ul>
        </td>
        <td class="value-cell pros-cell">
          <ul>{optionB.pros.map((pro) => <li>{pro}</li>)}</ul>
        </td>
      </tr>
      <tr class="cons-row">
        <td class="feature-cell">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d={iconPaths.x} />
          </svg>
          Cons
        </td>
        <td class="value-cell cons-cell">
          <ul>{optionA.cons.map((con) => <li>{con}</li>)}</ul>
        </td>
        <td class="value-cell cons-cell">
          <ul>{optionB.cons.map((con) => <li>{con}</li>)}</ul>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<style>
  .comparison-wrapper {
    margin-block: var(--spacing-element);
  }

  /* Mobile stacked cards */
  .comparison-mobile {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  @media (min-width: 768px) {
    .comparison-mobile {
      display: none;
    }
  }

  .comparison-card {
    background: var(--color-surface-elevated);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-xl);
    padding: 1.5rem;
  }

  .option-title {
    font-size: var(--font-size-xl);
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--color-border);
  }

  .feature-list {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin-bottom: 1.5rem;
  }

  .feature-row {
    display: flex;
    justify-content: space-between;
    gap: 1rem;
  }

  .feature-label {
    color: var(--color-text-muted);
    font-size: var(--font-size-sm);
  }

  .feature-value {
    font-weight: var(--font-weight-medium);
    text-align: right;
  }

  .pros-cons {
    display: grid;
    gap: 1rem;
  }

  .pros-title, .cons-title {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-semibold);
    margin-bottom: 0.5rem;
  }

  .pros-title {
    color: var(--color-success);
  }

  .cons-title {
    color: var(--color-error);
  }

  .pros ul, .cons ul {
    list-style: none;
    padding: 0;
    margin: 0;
    font-size: var(--font-size-sm);
  }

  .pros li, .cons li {
    padding-left: 1rem;
    position: relative;
    margin-bottom: 0.25rem;
  }

  .pros li::before {
    content: '✓';
    position: absolute;
    left: 0;
    color: var(--color-success);
  }

  .cons li::before {
    content: '–';
    position: absolute;
    left: 0;
    color: var(--color-error);
  }

  /* Desktop table */
  .comparison-table {
    display: none;
    width: 100%;
    border-collapse: collapse;
    background: var(--color-surface-elevated);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-xl);
    overflow: hidden;
  }

  @media (min-width: 768px) {
    .comparison-table {
      display: table;
    }
  }

  .comparison-table th,
  .comparison-table td {
    padding: 1rem 1.5rem;
    text-align: left;
    border-bottom: 1px solid var(--color-border);
  }

  .comparison-table thead {
    background: var(--color-surface-sunken);
  }

  .feature-header {
    font-weight: var(--font-weight-medium);
    color: var(--color-text-muted);
    width: 25%;
  }

  .option-header {
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-bold);
    width: 37.5%;
  }

  .feature-cell {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: var(--color-text-muted);
  }

  .feature-cell svg {
    color: var(--color-primary);
  }

  .value-cell {
    font-weight: var(--font-weight-medium);
  }

  .pros-cell ul, .cons-cell ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .pros-cell li {
    color: var(--color-success);
    padding-left: 1.25rem;
    position: relative;
    margin-bottom: 0.25rem;
  }

  .pros-cell li::before {
    content: '✓';
    position: absolute;
    left: 0;
  }

  .cons-cell li {
    color: var(--color-error);
    padding-left: 1.25rem;
    position: relative;
    margin-bottom: 0.25rem;
  }

  .cons-cell li::before {
    content: '✗';
    position: absolute;
    left: 0;
  }

  .comparison-table tr:last-child td {
    border-bottom: none;
  }
</style>
