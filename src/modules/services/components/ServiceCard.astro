---
/**
 * ServiceCard - Individual service card for services grid
 * Uses content collection data
 */

import type { CollectionEntry } from 'astro:content';

interface Props {
  service: CollectionEntry<'services'>;
}

const { service } = Astro.props;
const { title, shortDescription, icon, category, duration } = service.data;

const iconPaths: Record<string, string> = {
  tooth: 'M12 2C8 2 6 5 6 8c0 2 1 4 1 6 0 3-1 6 2 8 1.5 1 3 0 3-2v-4c0-1 1-2 2-2s2 1 2 2v4c0 2 1.5 3 3 2 3-2 2-5 2-8 0-2 1-4 1-6 0-3-2-6-6-6h-4z',
  implant: 'M12 2v4M12 6v4M12 10v4M12 14v4M8 22h8M9 6h6M10 10h4M10 14h4',
  crown: 'M3 12l3-9 3 6 3-6 3 6 3-6 3 9M3 12v6a3 3 0 003 3h12a3 3 0 003-3v-6',
  sparkle: 'M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z',
  shield: 'M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z',
  heart: 'M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z',
};

const categoryLabels: Record<string, string> = {
  preventive: 'Preventive',
  cosmetic: 'Cosmetic',
  restorative: 'Restorative',
  emergency: 'Emergency',
};
---

<article class="service-card">
  <div class="service-icon">
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <path d={iconPaths[icon] || iconPaths.tooth} />
    </svg>
  </div>

  <span class={`category-badge category-${category}`}>
    {categoryLabels[category]}
  </span>

  <h3 class="service-title">{title}</h3>
  <p class="service-description">{shortDescription}</p>

  {duration && (
    <p class="service-duration">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
        <circle cx="12" cy="12" r="10"/>
        <polyline points="12 6 12 12 16 14"/>
      </svg>
      {duration}
    </p>
  )}

  <a href={`/services/${service.id}`} class="service-link">
    Learn more
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <line x1="5" y1="12" x2="19" y2="12"/>
      <polyline points="12 5 19 12 12 19"/>
    </svg>
  </a>
</article>

<style>
  .service-card {
    /* 1:1.2 aspect ratio for proportional scaling */
    aspect-ratio: 1 / 1.2;
    display: flex;
    flex-direction: column;
    padding: 1.25rem;
    background: var(--color-surface-elevated);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--color-border);
    transition: box-shadow var(--transition-fast), transform var(--transition-fast);

    &:hover {
      box-shadow: var(--shadow-lg);
      transform: translateY(-4px);
    }
  }

  @media (min-width: 640px) {
    .service-card {
      padding: 1.5rem;
      border-radius: var(--radius-xl);
    }
  }

  @media (min-width: 1024px) {
    .service-card {
      padding: 2rem;
    }
  }

  .service-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    /* Responsive icon size */
    width: 48px;
    height: 48px;
    margin-bottom: 0.75rem;
    background: linear-gradient(135deg, var(--color-primary-light), var(--color-secondary-light));
    border-radius: var(--radius-lg);
    color: var(--color-primary-dark);

    & svg {
      width: 24px;
      height: 24px;
    }
  }

  @media (min-width: 640px) {
    .service-icon {
      width: 56px;
      height: 56px;
      margin-bottom: 0.875rem;

      & svg {
        width: 28px;
        height: 28px;
      }
    }
  }

  @media (min-width: 1024px) {
    .service-icon {
      width: 64px;
      height: 64px;
      margin-bottom: 1rem;

      & svg {
        width: 32px;
        height: 32px;
      }
    }
  }

  .category-badge {
    display: inline-block;
    width: fit-content;
    padding: 0.125rem 0.5rem;
    margin-bottom: 0.5rem;
    font-size: 0.625rem;
    font-weight: var(--font-weight-medium);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    border-radius: var(--radius-full);
  }

  @media (min-width: 640px) {
    .category-badge {
      padding: 0.1875rem 0.625rem;
      margin-bottom: 0.75rem;
      font-size: var(--font-size-xs);
    }
  }

  @media (min-width: 1024px) {
    .category-badge {
      padding: 0.25rem 0.75rem;
      margin-bottom: 1rem;
    }
  }

  .category-preventive {
    background: oklch(92% 0.08 145);
    color: oklch(35% 0.15 145);
  }

  .category-cosmetic {
    background: oklch(92% 0.08 85);
    color: oklch(40% 0.15 85);
  }

  .category-restorative {
    background: oklch(92% 0.08 240);
    color: oklch(40% 0.18 240);
  }

  .category-emergency {
    background: oklch(92% 0.10 25);
    color: oklch(45% 0.20 25);
  }

  .service-title {
    font-size: var(--font-size-sm);
    margin-bottom: 0.25rem;
    line-height: 1.3;
  }

  @media (min-width: 640px) {
    .service-title {
      font-size: var(--font-size-base);
      margin-bottom: 0.375rem;
    }
  }

  @media (min-width: 1024px) {
    .service-title {
      font-size: var(--font-size-xl);
      margin-bottom: 0.5rem;
    }
  }

  .service-description {
    font-size: var(--font-size-xs);
    color: var(--color-text-muted);
    line-height: var(--line-height-relaxed);
    margin-bottom: 0.5rem;
    flex-grow: 1;
    /* Limit lines on mobile */
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  @media (min-width: 640px) {
    .service-description {
      font-size: var(--font-size-sm);
      margin-bottom: 0.75rem;
      -webkit-line-clamp: 3;
    }
  }

  @media (min-width: 1024px) {
    .service-description {
      font-size: var(--font-size-base);
      margin-bottom: 1rem;
      -webkit-line-clamp: none;
    }
  }

  .service-duration {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: var(--font-size-xs);
    color: var(--color-text-muted);
    margin-bottom: 0.5rem;

    & svg {
      width: 12px;
      height: 12px;
    }
  }

  @media (min-width: 640px) {
    .service-duration {
      gap: 0.375rem;
      font-size: var(--font-size-sm);
      margin-bottom: 0.75rem;

      & svg {
        width: 14px;
        height: 14px;
      }
    }
  }

  @media (min-width: 1024px) {
    .service-duration {
      gap: 0.5rem;
      margin-bottom: 1.5rem;

      & svg {
        width: 16px;
        height: 16px;
      }
    }
  }

  .service-link {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    /* Minimum touch target 48px */
    min-height: 48px;
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-medium);
    color: var(--color-primary);
    text-decoration: none;
    transition: gap var(--transition-fast);
    margin-top: auto;

    & svg {
      width: 12px;
      height: 12px;
    }

    &:hover {
      gap: 0.5rem;
    }
  }

  @media (min-width: 640px) {
    .service-link {
      gap: 0.375rem;
      font-size: var(--font-size-sm);

      & svg {
        width: 14px;
        height: 14px;
      }

      &:hover {
        gap: 0.75rem;
      }
    }
  }

  @media (min-width: 1024px) {
    .service-link {
      gap: 0.5rem;

      & svg {
        width: 16px;
        height: 16px;
      }
    }
  }
</style>
