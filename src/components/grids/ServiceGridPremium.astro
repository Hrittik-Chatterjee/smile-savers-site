---
/**
 * Premium Service Grid Component
 *
 * Responsive grid layout:
 * - Mobile (<640px): 2 columns
 * - Tablet (640px+): 3 columns
 * - Desktop (1024px+): 4 columns
 *
 * Features:
 * - Section header with title and subtitle
 * - Decorative background shapes
 * - Call-to-action button
 * - WCAG 2.1 AA accessible
 */

import ServiceCardPremium from "../cards/ServiceCardPremium.astro";

export interface ServiceItem {
  id: string;
  title: string;
  description: string;
  icon: string;
  href: string;
  price?: string;
}

export interface Props {
  /** Array of services to display */
  services: ServiceItem[];
  /** Section title */
  title?: string;
  /** Section subtitle */
  subtitle?: string;
  /** Show CTA button */
  showCta?: boolean;
  /** CTA button text */
  ctaText?: string;
  /** CTA button link */
  ctaHref?: string;
}

const {
  services,
  title = "Our Services",
  subtitle = "Comprehensive dental care tailored to your needs",
  showCta = true,
  ctaText = "View All Services",
  ctaHref = "/services",
} = Astro.props;

const gradients = ["blue", "gold", "teal", "purple"] as const;
---

<section class="service-grid-premium" aria-labelledby="services-title">
  <!-- Background Decorative Shapes -->
  <div class="decorative-bg" aria-hidden="true">
    <div class="decorative-shape shape-1"></div>
    <div class="decorative-shape shape-2"></div>
  </div>

  <div class="container">
    <!-- Section Header -->
    <header class="section-header">
      <h2 id="services-title" class="section-title">{title}</h2>
      <p class="section-subtitle">{subtitle}</p>
    </header>

    <!-- Service Cards Grid -->
    <div class="services-grid" role="list" aria-label="Available dental services">
      {
        services.map((service: ServiceItem, index: number) => (
          <div role="listitem">
            <ServiceCardPremium
              {...service}
              gradient={gradients[index % gradients.length]}
              variant={index === 0 ? "featured" : "default"}
            />
          </div>
        ))
      }
    </div>

    <!-- Call to Action -->
    {
      showCta && (
        <div class="cta-container">
          <p class="cta-text">Looking for something specific?</p>
          <a href={ctaHref} class="cta-button">
            {ctaText}
            <svg
              class="cta-icon"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M13 7l5 5m0 0l-5 5m5-5H6"
              />
            </svg>
          </a>
        </div>
      )
    }
  </div>
</section>

<style>
  .service-grid-premium {
    position: relative;
    padding-block: var(--spacing-section);
    background: linear-gradient(
      180deg,
      var(--color-surface-elevated),
      var(--color-surface-elevated),
      var(--color-surface)
    );
    overflow: hidden;
  }

  /* Decorative Background */
  .decorative-bg {
    position: absolute;
    inset: 0;
    overflow: hidden;
    pointer-events: none;
  }

  .decorative-shape {
    position: absolute;
    border-radius: 9999px;
    filter: blur(60px);
    animation: float 6s ease-in-out infinite;
  }

  .shape-1 {
    top: 0;
    right: 25%;
    width: 24rem;
    height: 24rem;
    background: oklch(90% 0.05 240 / 0.3);
  }

  .shape-2 {
    bottom: 0;
    left: 25%;
    width: 24rem;
    height: 24rem;
    background: oklch(90% 0.05 85 / 0.3);
    animation-delay: -3s;
  }

  @keyframes float {
    0%,
    100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-20px);
    }
  }

  /* Container */
  .container {
    position: relative;
    z-index: 10;
    max-width: var(--container-xl);
    margin-inline: auto;
    padding-inline: var(--spacing-element);
  }

  /* Section Header */
  .section-header {
    text-align: center;
    margin-bottom: var(--spacing-block);
    max-width: 40rem;
    margin-inline: auto;
  }

  .section-title {
    font-size: var(--font-size-3xl);
    font-family: var(--font-family-heading);
    color: var(--color-text);
    margin-bottom: 0.75rem;
  }

  .section-subtitle {
    font-size: var(--font-size-lg);
    color: var(--color-text-muted);
    line-height: var(--line-height-relaxed);
    margin: 0;
  }

  /* Services Grid */
  .services-grid {
    display: grid;
    /* Mobile: 2 columns */
    grid-template-columns: repeat(2, 1fr);
    gap: 0.75rem;
  }

  @media (min-width: 640px) {
    .services-grid {
      /* Tablet: 3 columns */
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
    }
  }

  @media (min-width: 768px) {
    .services-grid {
      gap: 1.5rem;
    }
  }

  @media (min-width: 1024px) {
    .services-grid {
      /* Desktop: 4 columns */
      grid-template-columns: repeat(4, 1fr);
      gap: 2rem;
    }
  }

  /* CTA Container */
  .cta-container {
    text-align: center;
    margin-top: var(--spacing-block);
  }

  .cta-text {
    font-size: var(--font-size-base);
    color: var(--color-text-muted);
    margin-bottom: 1rem;
  }

  .cta-button {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    border-radius: var(--radius-lg);
    background: linear-gradient(135deg, var(--color-primary), oklch(50% 0.2 240));
    color: var(--color-text-inverted);
    font-weight: var(--font-weight-semibold);
    font-size: var(--font-size-sm);
    text-decoration: none;
    transition: all 0.3s ease;
    box-shadow: var(--shadow-md);

    &:hover {
      box-shadow: var(--shadow-lg), 0 0 20px oklch(65% 0.15 240 / 0.3);
      transform: translateY(-2px);
    }

    &:focus {
      outline: none;
      box-shadow: 0 0 0 2px var(--color-surface), 0 0 0 4px var(--color-primary);
    }
  }

  .cta-icon {
    width: 1.25rem;
    height: 1.25rem;
    transition: transform 0.3s ease;
  }

  .cta-button:hover .cta-icon {
    transform: translateX(4px);
  }

  /* Responsive Header */
  @media (min-width: 640px) {
    .section-header {
      margin-bottom: calc(var(--spacing-block) * 1.25);
    }

    .section-title {
      font-size: var(--font-size-4xl);
      margin-bottom: 1rem;
    }

    .cta-button {
      padding: 1rem 2rem;
      font-size: var(--font-size-base);
    }
  }

  @media (min-width: 1024px) {
    .section-header {
      margin-bottom: calc(var(--spacing-block) * 1.5);
    }

    .section-title {
      font-size: var(--font-size-5xl);
    }

    .cta-text {
      font-size: var(--font-size-lg);
      margin-bottom: 1.5rem;
    }
  }

  /* Dark mode */
  @media (prefers-color-scheme: dark) {
    .service-grid-premium {
      background: linear-gradient(
        180deg,
        oklch(15% 0.02 240),
        oklch(15% 0.02 240),
        oklch(12% 0.01 240)
      );
    }

    .shape-1 {
      background: oklch(30% 0.08 240 / 0.2);
    }

    .shape-2 {
      background: oklch(30% 0.08 85 / 0.2);
    }

    .cta-button:hover {
      box-shadow: var(--shadow-lg), 0 0 20px oklch(65% 0.15 240 / 0.2);
    }
  }

  /* Reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .decorative-shape {
      animation: none;
    }
  }
</style>
